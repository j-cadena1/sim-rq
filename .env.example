# Sim-Flow Production Environment Configuration
# =============================================
# For on-premise or VPS server deployment
# Copy this file to .env and fill in your production values
# NEVER commit .env to version control!

# ==========================================
# DOCKER VERSION CONFIGURATION
# ==========================================
# These control the base image versions used in Docker builds
# Defaults are stable LTS versions - only change if needed

# Node.js version (supports 18, 20, 22)
NODE_VERSION=20

# PostgreSQL version (supports 14, 15, 16, 17)
POSTGRES_VERSION=16

# Nginx version (alpine recommended for smaller images)
NGINX_VERSION=alpine

# ==========================================
# APPLICATION SETTINGS
# ==========================================
NODE_ENV=production
PORT=3001

# ==========================================
# DATABASE CONFIGURATION
# ==========================================
DB_HOST=postgres
DB_PORT=5432
DB_NAME=simflow
DB_USER=simflow_user
# Generate with: openssl rand -base64 24
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10

# ==========================================
# CORS CONFIGURATION (CRITICAL FOR PRODUCTION)
# ==========================================
# MUST be set to your public domain for SSO and cookies to work!
# This is the URL users will access in their browser
# Example: https://simflow.company.com
# For cloudflared/reverse proxy: use your public HTTPS URL
CORS_ORIGIN=https://simflow.yourdomain.com

# ==========================================
# RATE LIMITING
# ==========================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ==========================================
# LOGGING
# ==========================================
LOG_LEVEL=info

# ==========================================
# OPTIONAL: REDIS (for PKCE in multi-instance deployments)
# ==========================================
# REDIS_HOST=redis
# REDIS_PORT=6379
# REDIS_PASSWORD=

# ==========================================
# SSO ENCRYPTION (required if using Entra ID SSO)
# ==========================================
# Used to encrypt SSO client secrets at rest in the database
# Generate with: openssl rand -base64 32
SSO_ENCRYPTION_KEY=CHANGE_ME_USE_OPENSSL_RAND_BASE64_32

# ==========================================
# MICROSOFT ENTRA ID SSO NOTES
# ==========================================
# SSO is configured through the web UI (Settings > SSO Configuration)
# You'll need from Azure Portal:
#   - Tenant ID (Directory ID)
#   - Client ID (Application ID)
#   - Client Secret
#   - Redirect URI: https://your-domain.com/api/auth/sso/callback
#
# The Redirect URI in Azure app registration MUST match exactly
# what you enter in the Sim-Flow SSO settings.

# ==========================================
# OPTIONAL: AZURE KEY VAULT (for SSO secrets)
# ==========================================
# AZURE_KEY_VAULT_URL=https://your-vault.vault.azure.net/
# AZURE_CLIENT_ID=
# AZURE_CLIENT_SECRET=
# AZURE_TENANT_ID=
